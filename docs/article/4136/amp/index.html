<!DOCTYPE html>
<html amp lang="en-US">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
	<script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://uzzz.org/#website","url":"https://uzzz.org/","name":"\u6709\u7ec4\u7ec7\u5728!","potentialAction":{"@type":"SearchAction","target":"https://uzzz.org/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://uzzz.org/article/4136/#primaryimage","url":"https://img-my.csdn.net/uploads/201204/03/1333397468_9171.jpg"},{"@type":"WebPage","@id":"https://uzzz.org/article/4136/#webpage","url":"https://uzzz.org/article/4136/","inLanguage":"en-US","name":"\u3010Visual C++\u3011\u6e38\u620f\u5f00\u53d1\u7b14\u8bb0\u5341\u56db \u6e38\u620f\u753b\u9762\u7ed8\u56fe(\u56db) \u534e\u4e3d\u7684CImage\u7c7b - \u6709\u7ec4\u7ec7\u5728!","isPartOf":{"@id":"https://uzzz.org/#website"},"primaryImageOfPage":{"@id":"https://uzzz.org/article/4136/#primaryimage"},"datePublished":"2012-04-11T14:23:55+00:00","dateModified":"2012-04-11T14:23:55+00:00","author":{"@id":"https://uzzz.org/#/schema/person/29673f1347b0abda5882803c72ee5a3f"}},{"@type":["Person"],"@id":"https://uzzz.org/#/schema/person/29673f1347b0abda5882803c72ee5a3f","name":"fandyvon","sameAs":[]}]}</script>
	<title>【Visual C++】游戏开发笔记十四 游戏画面绘图(四) 华丽的CImage类 - 有组织在!</title>
		<link rel="canonical" href="https://uzzz.org/article/4136/">
	<script type="text/javascript" src="https://cdn.ampproject.org/v0.js" async></script>
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
	<style amp-custom>
		/* Generic WP styling */

.alignright {
	float: right;
}

.alignleft {
	float: left;
}

.aligncenter {
	display: block;
	text-align: center;
	margin-left: auto;
	margin-right: auto;
}

.amp-wp-enforced-sizes {
	/** Our sizes fallback is 100vw, and we have a padding on the container; the max-width here prevents the element from overflowing. **/
	max-width: 100%;
	margin: 0 auto;
}


/*
 * Prevent cases of amp-img converted from img to appear with stretching by using object-fit to scale.
 * See <https://github.com/ampproject/amphtml/issues/21371#issuecomment-475443219>.
 * Also use object-fit:contain in worst case scenario when we can't figure out dimensions for an image.
 * Additionally, in side of \AMP_Img_Sanitizer::determine_dimensions() it could $amp_img->setAttribute( 'object-fit', 'contain' )
 * so that the following rules wouldn't be needed.
 */
amp-img.amp-wp-enforced-sizes[layout="intrinsic"] > img,
amp-anim.amp-wp-enforced-sizes[layout="intrinsic"] > img {
	object-fit: contain;
}

amp-fit-text blockquote,
amp-fit-text h1,
amp-fit-text h2,
amp-fit-text h3,
amp-fit-text h4,
amp-fit-text h5,
amp-fit-text h6 {
	font-size: inherit;
}

/**
 * Override a style rule in Twenty Sixteen and Twenty Seventeen.
 * It set display:none for audio elements.
 * This selector is the same, though it adds body and uses amp-audio instead of audio.
 */
body amp-audio:not([controls]) {
	display: inline-block;
	height: auto;
}

/*
 * Style the default template messages for submit-success, submit-error, and submitting. These elements are inserted
 * by the form sanitizer when a POST form lacks the action-xhr attribute.
 */
.amp-wp-default-form-message > p {
	margin: 1em 0;
	padding: 0.5em;
}

.amp-wp-default-form-message[submitting] > p,
.amp-wp-default-form-message[submit-success] > p.amp-wp-form-redirecting {
	font-style: italic;
}

.amp-wp-default-form-message[submit-success] > p:not(.amp-wp-form-redirecting) {
	border: solid 1px #008000;
	background-color: #90ee90;
	color: #000;
}

.amp-wp-default-form-message[submit-error] > p {
	border: solid 1px #f00;
	background-color: #ffb6c1;
	color: #000;
}

/* Prevent showing empty success message in the case of an AMP-Redirect-To response header. */
.amp-wp-default-form-message[submit-success] > p:empty {
	display: none;
}

amp-carousel .amp-wp-gallery-caption {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	text-align: center;
	background-color: rgba(0, 0, 0, 0.5);
	color: #fff;
	padding: 1rem;
}

.wp-block-gallery[data-amp-carousel="true"] {
	display: block;
	flex-wrap: unset;
}

/* Template Styles */

.amp-wp-content,
.amp-wp-title-bar div {
		margin: 0 auto;
	max-width: 840px;
	}

html {
	background: #0a89c0;
}

body {
	background: #fff;
	color: #353535;
	font-family: Georgia, 'Times New Roman', Times, Serif;
	font-weight: 300;
	line-height: 1.75em;
}

p,
ol,
ul,
figure {
	margin: 0 0 1em;
	padding: 0;
}

a,
a:visited {
	color: #0a89c0;
}

a:hover,
a:active,
a:focus {
	color: #353535;
}

/* Quotes */

blockquote {
	color: #353535;
	background: rgba(127,127,127,.125);
	border-left: 2px solid #0a89c0;
	margin: 8px 0 24px 0;
	padding: 16px;
}

blockquote p:last-child {
	margin-bottom: 0;
}

/* UI Fonts */

.amp-wp-meta,
.amp-wp-header div,
.amp-wp-title,
.wp-caption-text,
.amp-wp-tax-category,
.amp-wp-tax-tag,
.amp-wp-comments-link,
.amp-wp-footer p,
.back-to-top {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif;
}

/* Header */

.amp-wp-header {
	background-color: #0a89c0;
}

.amp-wp-header div {
	color: #fff;
	font-size: 1em;
	font-weight: 400;
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: .875em 16px;
	position: relative;
}

.amp-wp-header a {
	color: #fff;
	text-decoration: none;
}


.amp-wp-header .amp-wp-site-icon {
	/** site icon is 32px **/
	background-color: #fff;
	border: 1px solid #fff;
	border-radius: 50%;
	position: absolute;
	right: 18px;
	top: 10px;
}

/* Article */

.amp-wp-article {
	color: #353535;
	font-weight: 400;
	margin: 1.5em auto;
	max-width: 840px;
	overflow-wrap: break-word;
	word-wrap: break-word;
}

/* Article Header */

.amp-wp-article-header {
	align-items: center;
	align-content: stretch;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	margin: 1.5em 16px 0;
}

.amp-wp-title {
	color: #353535;
	display: block;
	flex: 1 0 100%;
	font-weight: 900;
	margin: 0 0 .625em;
	width: 100%;
}

/* Article Meta */

.amp-wp-meta {
	color: #696969;
	display: inline-block;
	flex: 2 1 50%;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0 0 1.5em;
	padding: 0;
}

.amp-wp-article-header .amp-wp-meta:last-of-type {
	text-align: right;
}

.amp-wp-article-header .amp-wp-meta:first-of-type {
	text-align: left;
}

.amp-wp-byline amp-img,
.amp-wp-byline .amp-wp-author {
	display: inline-block;
	vertical-align: middle;
}

.amp-wp-byline amp-img {
	border: 1px solid #0a89c0;
	border-radius: 50%;
	position: relative;
	margin-right: 6px;
}

.amp-wp-posted-on {
	text-align: right;
}

/* Featured image */

.amp-wp-article-featured-image {
	margin: 0 0 1em;
}
.amp-wp-article-featured-image amp-img {
	margin: 0 auto;
}
.amp-wp-article-featured-image.wp-caption .wp-caption-text {
	margin: 0 18px;
}

/* Article Content */

.amp-wp-article-content {
	margin: 0 16px;
}

.amp-wp-article-content ul,
.amp-wp-article-content ol {
	margin-left: 1em;
}

.amp-wp-article-content .wp-caption {
	max-width: 100%;
}

.amp-wp-article-content amp-img {
	margin: 0 auto;
}

.amp-wp-article-content amp-img.alignright {
	margin: 0 0 1em 16px;
}

.amp-wp-article-content amp-img.alignleft {
	margin: 0 16px 1em 0;
}

/* Captions */

.wp-caption {
	padding: 0;
}

.wp-caption.alignleft {
	margin-right: 16px;
}

.wp-caption.alignright {
	margin-left: 16px;
}

.wp-caption .wp-caption-text {
	border-bottom: 1px solid #c2c2c2;
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: .66em 10px .75em;
}

/* AMP Media */

.alignwide,
.alignfull {
	clear: both;
}

amp-carousel {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}
amp-iframe,
amp-youtube,
amp-instagram,
amp-vine {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}

.amp-wp-article-content amp-carousel amp-img {
	border: none;
}

amp-carousel > amp-img > img {
	object-fit: contain;
}

.amp-wp-iframe-placeholder {
	background: #c2c2c2 url( https://uzzz.org/wp-content/plugins/amp/assets/images/placeholder-icon.png ) no-repeat center 40%;
	background-size: 48px 48px;
	min-height: 48px;
}

/* Article Footer Meta */

.amp-wp-article-footer .amp-wp-meta {
	display: block;
}

.amp-wp-tax-category,
.amp-wp-tax-tag {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 1.5em 16px;
}

.amp-wp-comments-link {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	text-align: center;
	margin: 2.25em 0 1.5em;
}

.amp-wp-comments-link a {
	border-style: solid;
	border-color: #c2c2c2;
	border-width: 1px 1px 2px;
	border-radius: 4px;
	background-color: transparent;
	color: #0a89c0;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 600;
	line-height: 18px;
	margin: 0 auto;
	max-width: 200px;
	padding: 11px 16px;
	text-decoration: none;
	width: 50%;
	-webkit-transition: background-color 0.2s ease;
			transition: background-color 0.2s ease;
}

/* AMP Footer */

.amp-wp-footer {
	border-top: 1px solid #c2c2c2;
	margin: calc(1.5em - 1px) 0 0;
}

.amp-wp-footer div {
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: 1.25em 16px 1.25em;
	position: relative;
}

.amp-wp-footer h2 {
	font-size: 1em;
	line-height: 1.375em;
	margin: 0 0 .5em;
}

.amp-wp-footer p {
	color: #696969;
	font-size: .8em;
	line-height: 1.5em;
	margin: 0 85px 0 0;
}

.amp-wp-footer a {
	text-decoration: none;
}

.back-to-top {
	bottom: 1.275em;
	font-size: .8em;
	font-weight: 600;
	line-height: 2em;
	position: absolute;
	right: 16px;
}
		/* Inline stylesheets */
.htmledit_views{font-family:-apple-system,SF UI Text,Arial,PingFang SC,Hiragino Sans GB,Microsoft YaHei,WenQuanYi Micro Hei,sans-serif,SimHei,SimSun}.htmledit_views a>amp-img{padding:1px;margin:1px;border:none;outline:#0782c1 solid 1px}.htmledit_views p{font-size:16px;color:#4d4d4d;font-weight:400;line-height:26px;margin:0 0 16px;overflow-x:auto}.htmledit_views amp-img{max-width:100%;height:auto}.htmledit_views strong,.htmledit_views strong span{font-weight:700}.htmledit_views *{box-sizing:border-box}.htmledit_views ol,.htmledit_views ul{margin:0 0 24px;padding:0;font-size:16px}.htmledit_views ul ol{margin:0 0 24px 32px}.htmledit_views ul li{list-style-type:disc;margin:8px 0 0 32px}.htmledit_views ol li{list-style-type:decimal;margin-left:40px;margin-top:8px}.htmledit_views blockquote{display:block;padding:16px 16px 0;margin:0 0 24px;border-left:8px solid #dddfe4;background:#eef0f4;overflow:auto;overflow-scrolling:touch;word-wrap:normal;word-break:normal}.htmledit_views blockquote ol,.htmledit_views blockquote ul{margin-bottom:16px;padding:0;font-size:16px;line-height:24px}.htmledit_views blockquote ol li,.htmledit_views blockquote ul li{margin-bottom:0}.htmledit_views blockquote p{font-size:16px;line-height:26px;font-weight:400;margin-bottom:16px;color:#4f4f4f}.htmledit_views a{color:#4ea1db;text-decoration:none}.htmledit_views a:focus,.htmledit_views a:hover{color:#ca0c16}.htmledit_views a:visited{color:#6795b5}.htmledit_views .dp-highlighter{font-size:12px;text-align:left;margin:0 0 24px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-b4b3d2b{color:#c60}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-f98b242{color:#00f}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-ee983c1{color:#939;font-family:"Microsoft YaHei";font-size:32px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-dcac5cf{font-family:"Microsoft YaHei";font-size:32px;color:#939}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-f43bbe7{position:absolute;left:462px;top:1353px;width:29px;height:14px;z-index:99}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-29d1c26{position:absolute;left:462px;top:1786px;width:29px;height:14px;z-index:99}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-1569ebb{font-family:"Microsoft YaHei";font-size:16px;color:#33f}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-da28f9e{font-size:18px;color:#090}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-39c2460{position:absolute;left:462px;top:2443px;width:29px;height:14px;z-index:99}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-7a7888b{font-size:16px;white-space:pre}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-d65b083{font-size:18px;color:#060}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-c19a530{position:absolute;left:462px;top:2835px;width:29px;height:14px;z-index:99}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-002e24e{font-family:"Microsoft YaHei";font-size:24px;color:#33f}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-6679ffe{font-family:"Microsoft YaHei";font-size:18px;color:#060}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-bcf6f4a{color:#060}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-ae09459{font-family:"Microsoft YaHei";font-size:18px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-0157bfd{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-822aa8c{font-family:Arial;font-size:14px;line-height:26px;text-align:left;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-1411ea0{font-family:"Microsoft YaHei";font-size:32px;color:#60c}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-c852c95{font-family:"Microsoft YaHei";font-size:18px;color:#660}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-b959104{font-size:18px;color:#660}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-322704a{font-family:"Microsoft YaHei"}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-2592cc7{font-size:16px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-d128b8e{font-family:Consolas,"Courier New",Courier,mono,serif;font-size:12px;background-color:#e7e5dc;width:1004px;overflow-x:auto;overflow-y:auto;padding-top:1px}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-d128b8e{margin-top:18px;margin-right:0px;margin-bottom:18px;margin-left:0px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-4490c99{padding-left:45px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-fd90ee4{padding-top:3px;padding-right:8px;padding-left:10px;font-family:Verdana,Geneva,Arial,Helvetica,sans-serif;font-size:9px;line-height:normal;color:silver;background-color:#f8f8f8;padding-bottom:10px;border-left-width:3px;border-left-style:solid;border-left-color:#999}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-d0be419{color:#a0a0a0;text-decoration:none;background-color:inherit;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:10px;margin-bottom:0px;margin-left:0px;font-size:9px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-a39554f{position:absolute;left:462px;top:6301px;width:29px;height:14px;z-index:99}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-f13af05{padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;list-style-position:initial;background-color:#fff;color:#5c5c5c}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-f13af05{margin-top:0px;margin-right:0px;margin-bottom:1px;margin-left:45px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-f2a3c2c{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;color:gray;background-color:inherit}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-7313745{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;color:red;background-color:inherit}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-63d6f57{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;color:#2e8b57;background-color:inherit;font-weight:bold}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-a22d019{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;color:#008200;background-color:inherit}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-a0215e9{border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:solid;border-width:initial;border-color:initial;list-style-type:decimal-leading-zero;border-left-width:3px;border-left-color:#999;background-color:#f5fae2;color:#555;line-height:18px}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-a0215e9{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:3px;padding-bottom:0px;padding-left:10px;list-style-position:outside}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-9eb6528{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;color:blue;background-color:inherit;font-weight:bold}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-1eb8bbc{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;background-color:inherit}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-42fb0af{border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:solid;border-width:initial;border-color:initial;list-style-type:decimal-leading-zero;border-left-width:3px;border-left-color:#999;background-color:#f5fae2;color:inherit;line-height:18px}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-42fb0af{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:3px;padding-bottom:0px;padding-left:10px;list-style-position:outside}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-dde744f{margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;color:black;background-color:inherit}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-73cea29{border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-9be0f60{color:#ca0000;text-decoration:none}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-0d5c54b{font-family:"Microsoft YaHei";font-size:24px;color:#c00}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-5a2ef6c{white-space:pre}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-6942f76{margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:0px}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-5485dc6{font-family:"Microsoft YaHei";font-size:16px}	</style>
</head>

<body class="">

<header id="top" class="amp-wp-header">
	<div>
		<a href="https://uzzz.org/">
										<amp-img src="https://uzzz.org/wp-content/uploads/2019/10/cropped-icon-32x32.png" width="32" height="32" class="amp-wp-site-icon"></amp-img>
						<span class="amp-site-title">
				有组织在!			</span>
		</a>

					</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">【Visual C++】游戏开发笔记十四 游戏画面绘图(四) 华丽的CImage类</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/e786821a74ef0467825a7d60183307bc?s=24&d=mm&r=g" alt="fandyvon" width="24" height="24" layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">fandyvon</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2012-04-11T22:23:55+00:00">
		8 years ago	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<p><br>
<br>
<br>
 </p>
<div id="article_content" class="article_content clearfix">
 
 
<div class="htmledit_views" id="content_views">
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><span class="amp-wp-b4b3d2b"><span class="amp-wp-2592cc7">本系列文章由zhmxy555编写，转载请注明出处。</span></span></span><span class="amp-wp-2592cc7"> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">作者：毛星云    邮箱： <a href="mailto:happylifemxy@qq.com" rel="nofollow" class="amp-wp-9be0f60"><span class="amp-wp-f98b242">happylifemxy@qq.com</span></a>    欢迎邮件交流编程心得</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我们知道，Visual C++中的CBitmap类的功能简直太弱小了，这曾经让Visual C++在图像处理方面的功能比较尴尬</span><span class="amp-wp-5485dc6">。之前笔记里面，我们采用的CBitmap配合GDI进行透明图像的处理有些晦涩繁琐，而且受到图像素材的限制，可以说是有些落后，不是太实用。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">为了解决这个问题，这节笔记我们将系统的学习MFC和ATL中新增一个图像处理的类，它就是华丽而强大的CImage类。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">由于本节笔记是对CImage类的一个非常系统近乎完全的介绍，我尽量让它涵盖到了CImage类的所有的属性和类成员，所以</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">篇幅也许比以往的笔记内容都长，里面的不少内容是用到的时候才需要掌握或者查阅的，并不用强行记忆。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-ee983c1">一，概念讲解部分</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-dcac5cf"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-dcac5cf"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e">1.CImage类的定位和概述</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">首先，我们简单介绍一下CImage类的定位。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">CImage是MFC和ATL共享的新类，它提供了增强的位图支持，包括加载、保存和转换JPEG，BMP，GIF，PNG图像格式的能力。可以说是微软意识到了CBitmap的不足，然后推出了一个CBitmap的增强版。使用CImage类，需在代码头部加入包含atlimage.h文件，即添加代码#include “atlimage.h”。</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">由于CImage拥有功能强大的类成员函数的支持，它便具有了下列四个比较出彩的特性： </span></p>
</div>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">1、AlphaBlend支持像素级的颜色混合，从而实现透明和半透明的效果。 </span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">2、PlgBlt能使一个矩形区域的位图映射到一个平行四边形区域中，而且还可能使用位屏蔽操作。 </span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">3、TransparentBlt在目标区域中产生透明图像</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">4、MaskBlt在目标区域中产生源位图与屏蔽位图合成的效果。</span></p>
</div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e">2.以CImage类做媒，让CBitmap类也能处理丰富的图片格式</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">解决的思路比较明朗，我们采用CImage类的Load函数加载图片，之后用Detch取得HBITMAP的句柄，然后再将此句柄附加给CBitmap的对象就行了。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">这样就实现了让CBitmap类也可以操作JPG/JPEG/GIF/PNG格式的图片。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">具体代码如下：</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<div class="dp-highlighter bg_cpp amp-wp-d128b8e">
<div class="bar amp-wp-4490c99">
<div class="tools amp-wp-fd90ee4">
       <strong>[cpp]</strong> <br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="ViewSource amp-wp-d0be419" title="view plain">view plain</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="CopyToClipboard amp-wp-d0be419" title="copy">copy</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="PrintSource amp-wp-d0be419" title="print">print</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="About amp-wp-d0be419" title="?">?</a> 
<div class="amp-wp-f43bbe7">
       </div>
</div>
</div>
<ol start="1" class="dp-cpp amp-wp-f13af05">
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="preprocessor amp-wp-f2a3c2c">#include “atlimage.h”</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">CImage image；               <span class="comment amp-wp-a22d019">//定义一个CBitmap类</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">image.Load（“filename”）； <span class="comment amp-wp-a22d019">//filename为要加载的文件地址</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HBITMAP</span><span class="amp-wp-1eb8bbc"> hBitmap=image.Detach(); </span><span class="comment amp-wp-a22d019">//返回被分离的图片的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">CBitmap bmp;                     <span class="comment amp-wp-a22d019">// 定义一个bitmap</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">bmp.Attach(hBitmap);        <span class="comment amp-wp-a22d019">//进行句柄的附加</span><span class="amp-wp-1eb8bbc">  </span></span></li>
</ol></div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">然后就可以用CBitmap进行余下的操作了。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e">3.CImage额外的一些性质</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">CImage类对于DIB（device-independent bitmap）设备无关位图文件和非DIB都可以处理。我们可以通过Create函数或者CImage：：Load来处理DIB部分，用Attach函数来将非DIB部分附加到一个CImage对象上。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">对于以下函数，只支持DIB部分的位图文件，他们是：</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetBitsGetColorTable，GetMaxColorTableEntries，GetPitch，GetPixelAddress，IsIndexed，SetColorTable。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我们可以通过CImage类中的IsDIBSection（）函数来帮助我们判断一个位图文件是否为DIB部分，其定义如下：</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p><div class="dp-highlighter bg_cpp amp-wp-d128b8e">
<div class="bar amp-wp-4490c99">
<div class="tools amp-wp-fd90ee4">
       <strong>[cpp]</strong> <br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="ViewSource amp-wp-d0be419" title="view plain">view plain</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="CopyToClipboard amp-wp-d0be419" title="copy">copy</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="PrintSource amp-wp-d0be419" title="print">print</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="About amp-wp-d0be419" title="?">?</a> 
<div class="amp-wp-29d1c26">
       </div>
</div>
</div>
<ol start="1" class="dp-cpp amp-wp-f13af05">
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">bool</span><span class="amp-wp-1eb8bbc"> IsDIBSection( ) </span><span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span><span class="comment amp-wp-a22d019">//如果返回值为true，则该文件为DIB；返回flase则不是DIB文件</span><span class="amp-wp-1eb8bbc">  </span></span></li>
</ol></div>
<p> <br>
    <span class="amp-wp-5485dc6"></span> </p>
<p class="amp-wp-6942f76">
</p><p>    <span class="amp-wp-5485dc6"><br> </span> </p>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我们需要注意的是，CImage不能被选到一个新的CDC（ class of device-context设备描述表的类），CImage会为图像创建自己的HDC（设备描述表DC的句柄）。因为一个HBITMAP只能被选入到一个HDC中一次，也就是说这个与CImage相关的HBITMAP不能被选到一个其他的HDC中。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">如果需要一个CDC，我们可以从CImage中获取HDC，然后使用CDC:：FromHandle函数。</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76"> </p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e">4.CImage兼容性的说明</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">在CImage中，有如下兼容性的要求：</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">只支持Windows NT4.0以上系统的成员函数：PlgBlt，MaskBlt，AlphaBlend。</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">只支持Windows 2000,98以上系统的成员函数：TransparentBlt，Draw</span></p>
</div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">其实由于目前都是Windows XP以上的操作系统，这个知识点了解一下就行。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e">5.CImage类用于贴图的一般的使用方法</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-1569ebb"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">使用方法不唯一，最常用的方法如下，该方法大致分为三部分：</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><span class="amp-wp-7a7888b"></span><span class="amp-wp-da28f9e"><1><strong> </strong></span><span class="amp-wp-2592cc7"><strong>在源文件中添加CImage类的包含文件</strong>： </span></span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><span class="amp-wp-5a2ef6c"></span>#include “atlimage.h”</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><span class="amp-wp-7a7888b"></span><span class="amp-wp-d65b083"><2></span><span class="amp-wp-2592cc7"> <strong>定义一个CImage类对象，然后调用CImage::Load方法装载一个外部图像文件。</strong>Load方法有如下两种重载：</span></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><span class="amp-wp-5a2ef6c"></span></span></p>
<div class="dp-highlighter bg_cpp amp-wp-d128b8e">
<div class="bar amp-wp-4490c99">
<div class="tools amp-wp-fd90ee4">
       <strong>[cpp]</strong> <br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="ViewSource amp-wp-d0be419" title="view plain">view plain</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="CopyToClipboard amp-wp-d0be419" title="copy">copy</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="PrintSource amp-wp-d0be419" title="print">print</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="About amp-wp-d0be419" title="?">?</a> 
<div class="amp-wp-39c2460">
       </div>
</div>
</div>
<ol start="1" class="dp-cpp amp-wp-f13af05">
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HRESULT</span><span class="amp-wp-1eb8bbc"> Load(  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">LPCTSTR</span><span class="amp-wp-1eb8bbc"> pszFileName    </span><span class="comment amp-wp-a22d019">//包含加载文件名的字符串指针</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">  </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">  </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HRESULT</span><span class="amp-wp-1eb8bbc"> Load(  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   IStream* pStream   <span class="comment amp-wp-a22d019">//指向包含加载文件名的流的指针</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">();  </span></span></li>
</ol></div>
<p> </p>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<p> </p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><span class="amp-wp-7a7888b"></span><span class="amp-wp-d65b083"><3> </span></span><span class="amp-wp-5485dc6"><strong>调用CImage::Draw方法绘制图像</strong>。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">下面重点介绍一下Draw方法。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">CImage::Draw  将一个位图文件从源设备描述表复制到当前设备描述表</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">该函数有如下六种重载：</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<div class="dp-highlighter bg_cpp amp-wp-d128b8e">
<div class="bar amp-wp-4490c99">
<div class="tools amp-wp-fd90ee4">
       <strong>[cpp]</strong> <br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="ViewSource amp-wp-d0be419" title="view plain">view plain</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="CopyToClipboard amp-wp-d0be419" title="copy">copy</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="PrintSource amp-wp-d0be419" title="print">print</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="About amp-wp-d0be419" title="?">?</a> 
<div class="amp-wp-c19a530">
       </div>
</div>
</div>
<ol start="1" class="dp-cpp amp-wp-f13af05">
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> Draw(  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hDestDC,         </span><span class="comment amp-wp-a22d019">//目标设备环境DC的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> xDest,           </span><span class="comment amp-wp-a22d019">//目的矩形的左上角X坐标（逻辑单位）</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> yDest,           </span><span class="comment amp-wp-a22d019">//目的矩形的左上角Y坐标（逻辑单位）</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nDestWidth,     </span><span class="comment amp-wp-a22d019">//目标矩形的宽度（就是设定贴过去的图片的宽度）</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nDestHeight,    </span><span class="comment amp-wp-a22d019">//目标矩形的高度（就是设定铁锅的图片的高度）</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> xSrc,            </span><span class="comment amp-wp-a22d019">//源矩形的左上角X坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> ySrc,            </span><span class="comment amp-wp-a22d019">//源矩形的左上角Y坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nSrcWidth,      </span><span class="comment amp-wp-a22d019">//源矩形的宽度</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nSrcHeight      </span><span class="comment amp-wp-a22d019">//源矩形的高度</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">  </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">  </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> Draw(  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hDestDC,       </span><span class="comment amp-wp-a22d019">//目标环境DC的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> RECT& rectDest,        </span><span class="comment amp-wp-a22d019">//一个RECT结构的引用，用来确定目标图像。</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> RECT& rectSrc         </span><span class="comment amp-wp-a22d019">//一个RECT结构体的引用，用来确定源图像</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">  </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">  </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> Draw(  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hDestDC,         </span><span class="comment amp-wp-a22d019">//目标环境DC的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> xDest,        </span><span class="comment amp-wp-a22d019">//目标矩形的左上角X坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> yDest         </span><span class="comment amp-wp-a22d019">//目标矩形的左上角Y坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );        </span><span class="comment amp-wp-a22d019">//</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> Draw(  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hDestDC,        </span><span class="comment amp-wp-a22d019">//目标环境DC的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> POINT& pointDest         </span><span class="comment amp-wp-a22d019">//一个POINT结构体，用来确定目的矩形的左上角坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">  </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">  </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> Draw(  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hDestDC,        </span><span class="comment amp-wp-a22d019">//目标环境DC的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> xDest,        </span><span class="comment amp-wp-a22d019">//目标矩形的左上角X坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> yDest,        </span><span class="comment amp-wp-a22d019">//目标矩形的左上角Y坐标</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nDestWidth,        </span><span class="comment amp-wp-a22d019">//目标矩形的宽度</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nDestHeight         </span><span class="comment amp-wp-a22d019">//目标矩形的宽度</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">  </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">  </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> Draw(  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hDestDC,        </span><span class="comment amp-wp-a22d019">//目标环境DC的句柄</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> RECT& rectDest         </span><span class="comment amp-wp-a22d019">//一个RECT结构的引用，用来确定目标图像。</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">) <span class="keyword amp-wp-9eb6528">const</span><span class="amp-wp-1eb8bbc"> </span><span class="keyword amp-wp-9eb6528">throw</span><span class="amp-wp-1eb8bbc">( );  </span></span></li>
</ol></div>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76"> </p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">在上面的Draw函数的各种重载中，对于没有指定源矩形的版本，则整个源图像就是默认的源矩形。对于没有指定目的矩形尺寸的，则源图片的尺寸就是默认的目的矩形尺寸。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">需要注意的是，Draw方法综合了StretchBlt、TransparentBlt和AlphaBlend函数的功能。。通常情况下，Draw（）函数作用和StretchBlt（）函数一致。但是当我们的图像中存在透明的颜色和alpha通道的时候，Draw（）函数作用和TransparentBlt（）或者AlphaBlend（）函数一致。所以，在一般情况下，我们都尽量调用Draw方法来绘制图像。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76"> </p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e">6.对CImage所有类成员的介绍</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-002e24e"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我将CImage类的所有类函数按功能分为了四大类，可以更方面的了解各函数的定位和作用，也方便大家查阅：</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-6679ffe"><strong><1></strong></span><span class="amp-wp-5485dc6"><strong>功能为创建与连接，释放的函数</strong></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><strong><br> </strong></span></p>
</div>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Attach         附加一个HBITMAP到CImage对象，位图类型DIB与否都可以</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Create         创建一个DIB部分的位图，并将其附加到之前创建的CImage对象</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">CreateEX      创建一个DIB部分的位图（拥有额外的参数），并将其附加到之前 创建的CImage对象</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Destroy       从CImage类上分离该位图并进行删除</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Detach       从CImage类里分离该位图</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">ReleaseDC                释放设备描述表中的数据</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">ReleaseGDIPlus             释放GDI+使用的源</span></p>
</div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-6679ffe"><strong><2></strong></span><span class="amp-wp-5485dc6"><strong>功能为输入与输出的函数</strong></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><strong><br> </strong></span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetExporterFilterString 返回系统支持的输入文件格式类型及其描述</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetImporterFilterString 返回系统支持的输出文件格式类型及其描述</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">LoadFromResource           从指定的源处加载一个图像资源</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Load                        从指定文件处加载一个图像资源</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">IsIndexed            判断一个位图颜色映射到了一个索引调色盘</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">IsNull                判断一个源位图是否被当前载入</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Save                       以指定的类型来保存图像</span></p>
</div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-ae09459"><strong><span class="amp-wp-bcf6f4a"><3></span>关于位图类型与参数的函数</strong></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-ae09459"><strong><br> </strong></span></p>
</div>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetBits        返回一个指向该位图实际像素值指针</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetBPP        返回该位图每个像素的位</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetColorTable  返回颜色表中RGB值的范围条目</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetDC         返回目前被选择的设备描述表</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetExporterFilterString 返回系统支持的输入文件格式类型及其描述</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetImporterFilterString 返回系统支持的输出文件格式类型及其描述</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetHeight          返回当前图像的像素高度</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetMaxColorTableEntries    返回颜色表条目中的最大值</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetPitch             返回当前图片的间距（单位为字节），用来决定像素格式的</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetTransparentColor  返回颜色表中透明色的位置</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">GetWidth            返回当前图片的宽度（单位为像素）</span></p>
</div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-ae09459"><strong><span class="amp-wp-bcf6f4a"><4></span>功能为图形绘制与位图块传输相关的函数</strong></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-ae09459"><strong><br> </strong></span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">AlphaBlend     显示一个半透明或者透明像素的位图</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">BitBlt          从源设备描述表复制一个位图文件到当前设备描述表</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">Draw         从源矩形复制一个位图到目的矩形，该函数伸缩或者拉伸位图来适应目标矩 形的尺寸，如果有必要，会处理Alpha值和透明颜色。</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">MaskBlt                     用指定的掩码和光栅操作来结合颜色数据和目的位图</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">PlgBlt                       执行一个从源设备描述表的矩形到目标设备描述表的平行 四边形的块状位图转换</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">SetColorTabel              在DIB的颜色表中设定一系列条目的RGB颜色的值</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">SetPixelIndexed            设置在指定坐标处的像素（使用索调色板的索引值）。</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">SetPixelRGB                设置在指定坐标处的像素（使用RGB值）</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">SetPixel                    在指定坐标处设置像素的颜色</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">SetTransparentColor        设置将被视为透明色的颜色的索引值（只能选取调色板中的 一种颜色）</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">StretchBlt                  从源矩形复制一个位图到目的矩形，如果有必要，该函数会 伸缩或者拉伸位图来适应目标矩形的尺寸，</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">TransparentBlt              从源设备描述表中复制一个带有透明色的位图到当前设备 描述表</span></p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76">
</p></div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76"> </p>
<p class="amp-wp-6942f76"> </p>
<p class="amp-wp-6942f76"> </p>
<p class="amp-wp-6942f76"> </p>
</div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76">
</p></div>
</blockquote>
<blockquote class="amp-wp-0157bfd">
<div>
<p class="amp-wp-6942f76">
</p></div>
</blockquote>
</blockquote>
<blockquote class="amp-wp-822aa8c">
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-1411ea0">二，实例运用部分</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-1411ea0"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">运用CImage完成透明贴图的一个完整实例</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">介绍了这么多了，下面我们依然用一个实例来巩固本节笔记的知识。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我们知道，CImage支持透明PNG的贴图，下面我们就运用透明PNG的贴图，来代替之前的掩码操作贴图。</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-c852c95"><第一步></span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">准备两张素材图，一张背景图，一张需要进行透明操作的人物图。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">这次的选材就很广了，没有之前透明操作需要自己一定的美工功底或者美工童鞋支持的诸多限制了。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我选的两张图片素材如下：</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">背景图 bg.bmp  640×444</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">人物图  onion.bmp  130×130（呵呵，可爱的洋葱头~~）</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <amp-img src="https://img-my.csdn.net/uploads/201204/03/1333397468_9171.jpg" alt="" object-fit="contain" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes amp-wp-73cea29" layout="intrinsic"><noscript><img src="https://img-my.csdn.net/uploads/201204/03/1333397468_9171.jpg" alt="" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-73cea29"></noscript></amp-img></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p><p class="amp-wp-6942f76"> </p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><strong><span class="amp-wp-b959104"><第二步></span></strong></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><span class="amp-wp-2592cc7">将人物图 onion.bmp用photoshop等图像处理软件进行抠图操作，除去红黄相间的背景图，并将背景图用透明图层代替，再将图片大小调节成85×113，用png格式输出，效果如下：</span></span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">处理好的人物图  onion.png  85×113</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><amp-img src="https://img-my.csdn.net/uploads/201204/03/1333397484_7261.png" alt="" object-fit="contain" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes amp-wp-73cea29" layout="intrinsic"><noscript><img src="https://img-my.csdn.net/uploads/201204/03/1333397484_7261.png" alt="" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-73cea29"></noscript></amp-img><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><strong><span class="amp-wp-b959104"><第三步></span></strong></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-322704a"><span class="amp-wp-2592cc7">将bg.bmp以及onion.png放到工程目录下，并在源文件写入代码并运行。</span></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">该代码和笔记六中代码的思路基本相同，只不过，将笔记六中使用掩码操作进行透明化处理的方式换成了png透明贴图的方式，更加的直观和易懂易用。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">详细注释的源代码如下</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<div class="dp-highlighter bg_cpp amp-wp-d128b8e">
<div class="bar amp-wp-4490c99">
<div class="tools amp-wp-fd90ee4">
       <strong>[cpp]</strong> <br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="ViewSource amp-wp-d0be419" title="view plain">view plain</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="CopyToClipboard amp-wp-d0be419" title="copy">copy</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="PrintSource amp-wp-d0be419" title="print">print</a><br>
       <a href="http://blog.csdn.net/zhmxy555/article/details/7422922#" class="About amp-wp-d0be419" title="?">?</a> 
<div class="amp-wp-a39554f">
       </div>
</div>
</div>
<ol start="1" class="dp-cpp amp-wp-f13af05">
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="preprocessor amp-wp-f2a3c2c">#include “stdafx.h”  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="preprocessor amp-wp-f2a3c2c">#include “atlimage.h”</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//全局变量声明  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc"> hInst;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HBITMAP</span><span class="amp-wp-1eb8bbc"> bg;        </span><span class="comment amp-wp-a22d019">//声明一个位图对象，用于存储背景图  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc">  mdc;        </span><span class="comment amp-wp-a22d019">//声明一个内存DC”mdc”，用来暂存位图</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//全局函数声明  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">ATOM</span><span class="amp-wp-1eb8bbc">     MyRegisterClass(</span><span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc"> hInstance);    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc">     InitInstance(</span><span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc">, </span><span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc">);    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">LRESULT</span><span class="amp-wp-1eb8bbc"> CALLBACK    WndProc(</span><span class="datatypes amp-wp-63d6f57">HWND</span><span class="amp-wp-1eb8bbc">, </span><span class="datatypes amp-wp-63d6f57">UINT</span><span class="amp-wp-1eb8bbc">, </span><span class="datatypes amp-wp-63d6f57">WPARAM</span><span class="amp-wp-1eb8bbc">, </span><span class="datatypes amp-wp-63d6f57">LPARAM</span><span class="amp-wp-1eb8bbc">);    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">void</span><span class="amp-wp-1eb8bbc">     MyPaint(</span><span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hdc);    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">////****Winmain函数，程序入口点函数**************************************  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> APIENTRY WinMain(</span><span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc"> hInstance,    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">                     <span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc"> hPrevInstance,    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">                     <span class="datatypes amp-wp-63d6f57">LPSTR</span><span class="amp-wp-1eb8bbc">     lpCmdLine,    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">                     <span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc">       nCmdShow)    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">{    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">MSG msg;    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">MyRegisterClass(hInstance);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">if</span><span class="amp-wp-1eb8bbc"> (!InitInstance (hInstance, nCmdShow))     </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">{    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> FALSE;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">}    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//消息循环  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">while</span><span class="amp-wp-1eb8bbc"> (GetMessage(&msg, NULL, 0, 0))     </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">{    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">TranslateMessage(&msg);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">DispatchMessage(&msg);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">}    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> msg.wParam;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">}    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//****设计一个窗口类，类似填空题，使用窗口结构体*************************  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">ATOM</span><span class="amp-wp-1eb8bbc"> MyRegisterClass(</span><span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc"> hInstance)    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">{    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">WNDCLASSEX wcex;    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.cbSize = <span class="keyword amp-wp-9eb6528">sizeof</span><span class="amp-wp-1eb8bbc">(WNDCLASSEX);     </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">wcex.style   = CS_HREDRAW | CS_VREDRAW;    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.lpfnWndProc    = (WNDPROC)WndProc;    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">wcex.cbClsExtra  = 0;    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.cbWndExtra  = 0;    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">wcex.hInstance   = hInstance;    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.hIcon   = LoadIcon(NULL,IDI_APPLICATION);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">wcex.hCursor     = NULL;    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.hCursor     = LoadCursor(NULL, IDC_ARROW);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">wcex.hbrBackground  = (<span class="datatypes amp-wp-63d6f57">HBRUSH</span><span class="amp-wp-1eb8bbc">)(COLOR_WINDOW+1);    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.lpszMenuName   = NULL;    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">wcex.lpszClassName  = <span class="string amp-wp-7313745">“canvas”</span><span class="amp-wp-1eb8bbc">;    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">wcex.hIconSm     = NULL;    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> RegisterClassEx(&wcex);    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">}    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//****初始化函数*************************************  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">// 1.建立与窗口DC兼容的内存DC  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">// 2.从文件加载背景图及透明的洋葱头 </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">BOOL</span><span class="amp-wp-1eb8bbc"> InitInstance(</span><span class="datatypes amp-wp-63d6f57">HINSTANCE</span><span class="amp-wp-1eb8bbc"> hInstance, </span><span class="datatypes amp-wp-63d6f57">int</span><span class="amp-wp-1eb8bbc"> nCmdShow)    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">{    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HWND</span><span class="amp-wp-1eb8bbc"> hWnd;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hdc;    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">hInst = hInstance;    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">hWnd = CreateWindow(<span class="string amp-wp-7313745">“canvas”</span><span class="amp-wp-1eb8bbc">, </span><span class="string amp-wp-7313745">“浅墨的绘图窗口”</span><span class="amp-wp-1eb8bbc"> , WS_OVERLAPPEDWINDOW,    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">if</span><span class="amp-wp-1eb8bbc"> (!hWnd)    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">{    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> FALSE;    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">}    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">MoveWindow(hWnd,10,10,600,444,<span class="keyword amp-wp-9eb6528">true</span><span class="amp-wp-1eb8bbc">);    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">ShowWindow(hWnd, nCmdShow);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">UpdateWindow(hWnd);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">hdc = GetDC(hWnd);                     <span class="comment amp-wp-a22d019">//获得窗口DC  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">mdc = CreateCompatibleDC(hdc);           <span class="comment amp-wp-a22d019">//创建与窗口兼容的内存DC(mdc)  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">bg = (<span class="datatypes amp-wp-63d6f57">HBITMAP</span><span class="amp-wp-1eb8bbc">)LoadImage(NULL,</span><span class="string amp-wp-7313745">“bg.bmp”</span><span class="amp-wp-1eb8bbc">,IMAGE_BITMAP,600,444,LR_LOADFROMFILE);    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">MyPaint(hdc);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">ReleaseDC(hWnd,hdc);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> TRUE;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">}    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//****自定义绘图函数*********************************  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//透明贴图  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">void</span><span class="amp-wp-1eb8bbc"> MyPaint(</span><span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hdc)    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">{    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">SelectObject(mdc,bg);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">BitBlt(hdc,0,0,600,450,mdc,0,0,SRCCOPY);    <span class="comment amp-wp-a22d019">//先将背景图贴到显示窗口中  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">CImage image;      <span class="comment amp-wp-a22d019">//定义一个CImage对象，用于透明贴图</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">CString str;      <span class="comment amp-wp-a22d019">//定义一个CString对象，用于存放文件名字符串</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">str=<span class="string amp-wp-7313745">“onion.png”</span><span class="amp-wp-1eb8bbc">;              </span><span class="comment amp-wp-a22d019">//将字符串赋值为文件名</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">image.Load(str);                    <span class="comment amp-wp-a22d019">//在image中载入图像文件</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">image.Draw(hdc,120,180,85,113,0,0,85,113);    <span class="comment amp-wp-a22d019">//调用Draw进行透明贴图</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//或者为image.TransparentBlt(hdc, 120, 180, 85, 113,CLR_INVALID );//调用TransparentBlt进行透明贴图</span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">image.Destroy();  </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">}    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="comment amp-wp-a22d019">//****消息处理函数**********************************  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">LRESULT</span><span class="amp-wp-1eb8bbc"> CALLBACK WndProc(</span><span class="datatypes amp-wp-63d6f57">HWND</span><span class="amp-wp-1eb8bbc"> hWnd, </span><span class="datatypes amp-wp-63d6f57">UINT</span><span class="amp-wp-1eb8bbc"> message, </span><span class="datatypes amp-wp-63d6f57">WPARAM</span><span class="amp-wp-1eb8bbc"> wParam, </span><span class="datatypes amp-wp-63d6f57">LPARAM</span><span class="amp-wp-1eb8bbc"> lParam)    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">{    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">PAINTSTRUCT ps;    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="datatypes amp-wp-63d6f57">HDC</span><span class="amp-wp-1eb8bbc"> hdc;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">switch</span><span class="amp-wp-1eb8bbc"> (message)    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">{    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">case</span><span class="amp-wp-1eb8bbc"> WM_PAINT:   </span><span class="comment amp-wp-a22d019">//窗口重绘消息  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">hdc = BeginPaint(hWnd, &ps);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">MyPaint(hdc);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">EndPaint(hWnd, &ps);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">break</span><span class="amp-wp-1eb8bbc">;    </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">case</span><span class="amp-wp-1eb8bbc"> WM_DESTROY:     </span><span class="comment amp-wp-a22d019">//窗口结束消息  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">DeleteDC(mdc);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">DeleteObject(bg);    </span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">PostQuitMessage(0);    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">break</span><span class="amp-wp-1eb8bbc">;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">default</span><span class="amp-wp-1eb8bbc">:     </span><span class="comment amp-wp-a22d019">//其他消息  </span><span class="amp-wp-1eb8bbc">  </span></span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f"><span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> DefWindowProc(hWnd, message, wParam, lParam);    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">   }    </span></li>
<li class="amp-wp-a0215e9"> <span class="amp-wp-dde744f">   <span class="keyword amp-wp-9eb6528">return</span><span class="amp-wp-1eb8bbc"> 0;    </span></span></li>
<li class="alt amp-wp-42fb0af"> <span class="amp-wp-dde744f">}    </span></li>
</ol></div>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">最后得到的效果图如下：</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><amp-img src="https://img-my.csdn.net/uploads/201204/03/1333397336_1824.jpg" alt="" object-fit="contain" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes amp-wp-73cea29" layout="intrinsic"><noscript><img src="https://img-my.csdn.net/uploads/201204/03/1333397336_1824.jpg" alt="" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-73cea29"></noscript></amp-img><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">我们可以改变CImage::Draw函数的参数值，让“洋葱头”出现在地图不同的地方。</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> </p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><amp-img src="https://img-my.csdn.net/uploads/201204/03/1333397361_8832.jpg" alt="" object-fit="contain" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-enforced-sizes amp-wp-73cea29" layout="intrinsic"><noscript><img src="https://img-my.csdn.net/uploads/201204/03/1333397361_8832.jpg" alt="" width="840" height="400" class="amp-wp-unknown-size amp-wp-unknown-width amp-wp-unknown-height amp-wp-73cea29"></noscript></amp-img><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">通过这个实例可以发现，用CImage类进行透明贴图，实在是方便多了。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">本节笔记到这里就结束了，由于近期在做一个纯flash的网站，更新速度和评论的回复都不像往常那么及时，希望大家能够体谅。</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-0d5c54b">本节笔记的源代码请点击这里下载：   <a href="http://download.csdn.net/detail/zhmxy555/4196333" target="_blank" rel="noopener noreferrer" class="amp-wp-9be0f60">【Visual C++】Code_Note_14</a></span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-0d5c54b"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">感谢一直支持【Visual C++】游戏开发笔记系列专栏的朋友们，也请大家继续关注我的专栏，我一有时间就会把自己的学习心得，觉得比较好的知识点写出来和大家一起分享。</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">精通游戏开发的路还很长很长，非常希望能和大家一起交流，共同学习，共同进步。</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">大家看过后觉得值得一看的话，可以顶一下这篇文章，你们的支持是我继续写下去的动力~</span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">如果文章中有什么疏漏的地方，也请大家指正。也希望大家可以多留言来和我探讨编程相关的问题。</span></p>
</div>
<div>
<p class="amp-wp-6942f76">
</p></div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">最后，谢谢你们一直的支持~~~</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><span class="amp-wp-5a2ef6c"></span>——————————浅墨于2012年4月3日</span></p>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6"><br> </span></p>
</div>
<div>
<p class="amp-wp-6942f76"> <span class="amp-wp-5485dc6">The end.</span></p>
</div>
</blockquote></div>
<div class="more-toolbox">
<div class="left-toolbox">
<ul class="toolbox-list">
<li class="tool-item tool-active is-like "><a><br>
      <svg class="icon" aria-hidden="true"><br>
       <use xlink:href="#csdnc-thumbsup"></use><br>
      </svg><span class="name">点赞</span> <span class="count"></span> </a></li>
<li class="tool-item tool-active is-collection "><a data-report-click='{"mod":"popu_824"}'><br>
      <svg class="icon" aria-hidden="true"><br>
       <use xlink:href="#icon-csdnc-Collection-G"></use><br>
      </svg><span class="name">收藏</span></a></li>
<li class="tool-item tool-active is-share"><a data-report-click='{"mod":"1582594662_002"}'><br>
      <svg class="icon" aria-hidden="true"><br>
       <use xlink:href="#icon-csdnc-fenxiang"></use><br>
      </svg>分享</a></li>
<p>    <br>
     </p>
<li class="tool-item tool-more"> <a><br>
      <svg class="icon" viewbox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><br>
       <defs>

<p>       </p></defs>
       <path d="M179.176 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z"></path>
       <path d="M509.684 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z"></path>
       <path d="M846.175 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z"></path>
      </svg> </a> 
<ul class="more-box">
<li class="item"><a class="article-report">文章举报</a></li>
</ul>
</li>
</ul></div>
</div>
<div class="person-messagebox">
<div class="left-message">
   <a href="https://blog.csdn.net/xyz121323693"> <amp-img src="https://profile.csdnimg.cn/7/F/7/3_xyz121323693" class="avatar_pic amp-wp-enforced-sizes" width="48" height="48" layout="intrinsic"><noscript><img src="https://profile.csdnimg.cn/7/F/7/3_xyz121323693" class="avatar_pic" width="48" height="48"></noscript></amp-img> <amp-img src="https://g.csdnimg.cn/static/user-reg-year/1x/10.png" class="user-years amp-wp-enforced-sizes" width="23" height="22" layout="intrinsic"><noscript><img src="https://g.csdnimg.cn/static/user-reg-year/1x/10.png" class="user-years" width="23" height="22"></noscript></amp-img> </a>
  </div>
<div class="middle-message">
<div class="title">
    <span class="tit"><a href="https://blog.csdn.net/xyz121323693" data-report-click='{"mod":"popu_379"}' target="_blank" rel="noopener noreferrer">汗血马</a></span>
   </div>
<div class="text">
    <span>发布了14 篇原创文章</span> ·<br>
    <span>获赞 3</span> ·<br>
    <span>访问量 4万+</span>
   </div>
</div>
<div class="right-message">
   <a href="https://im.csdn.net/im/main.html?userName=xyz121323693" target="_blank" class="btn btn-sm btn-red-hollow bt-button personal-letter" rel="noopener noreferrer">私信 </a><br>
   <a class="btn btn-sm  bt-button personal-watch" data-report-click='{"mod":"popu_379"}'>关注</a>
  </div>
</div>
</div>
	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: Uncategorized	</div>

	<div class="amp-wp-meta amp-wp-tax-tag">
		Tags: <a href="https://uzzz.org/tag/c/" rel="tag">c++</a>, <a href="https://uzzz.org/tag/image/" rel="tag">image</a>, <a href="https://uzzz.org/tag/mfc/" rel="tag">mfc</a>, <a href="https://uzzz.org/tag/null/" rel="tag">null</a>, <a href="https://uzzz.org/tag/tuxiangchuli/" rel="tag">图像处理</a>, <a href="https://uzzz.org/tag/youxi/" rel="tag">游戏</a>	</div>
	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>有组织在!</h2>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>



</body>
</html>
