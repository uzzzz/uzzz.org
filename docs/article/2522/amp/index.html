<!DOCTYPE html>
<html amp lang="en-US">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
		<title>python数据分析：关联规则学习（Association rule learning） – 有组织在!</title>
		<link rel="canonical" href="https://uzzz.org/article/2522/">
	<script type="text/javascript" src="https://cdn.ampproject.org/v0.js" async></script>
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>	<script type="application/ld+json">{"@context":"http:\/\/schema.org","publisher":{"@type":"Organization","name":"有组织在!","logo":"https:\/\/uzzz.org\/wp-content\/uploads\/2019\/10\/cropped-icon.png"},"@type":"BlogPosting","mainEntityOfPage":"https:\/\/uzzz.org\/article\/2522\/","headline":"python数据分析：关联规则学习（Association rule learning）","datePublished":"2018-12-01T06:58:03+00:00","dateModified":"2018-12-01T06:58:03+00:00","author":{"@type":"Person","name":"fandyvon"}}</script>
	
	<style amp-custom>
		/* Generic WP styling */

.alignright {
	float: right;
}

.alignleft {
	float: left;
}

.aligncenter {
	display: block;
	text-align: center;
	margin-left: auto;
	margin-right: auto;
}

.amp-wp-enforced-sizes {
	/** Our sizes fallback is 100vw, and we have a padding on the container; the max-width here prevents the element from overflowing. **/
	max-width: 100%;
	margin: 0 auto;
}


/*
 * Prevent cases of amp-img converted from img to appear with stretching by using object-fit to scale.
 * See <https://github.com/ampproject/amphtml/issues/21371#issuecomment-475443219>.
 * Also use object-fit:contain in worst case scenario when we can't figure out dimensions for an image.
 * Additionally, in side of \AMP_Img_Sanitizer::determine_dimensions() it could $amp_img->setAttribute( 'object-fit', 'contain' )
 * so that the following rules wouldn't be needed.
 */
amp-img.amp-wp-enforced-sizes[layout="intrinsic"] > img,
amp-anim.amp-wp-enforced-sizes[layout="intrinsic"] > img {
	object-fit: contain;
}

amp-fit-text blockquote,
amp-fit-text h1,
amp-fit-text h2,
amp-fit-text h3,
amp-fit-text h4,
amp-fit-text h5,
amp-fit-text h6 {
	font-size: inherit;
}

/**
 * Override a style rule in Twenty Sixteen and Twenty Seventeen.
 * It set display:none for audio elements.
 * This selector is the same, though it adds body and uses amp-audio instead of audio.
 */
body amp-audio:not([controls]) {
	display: inline-block;
	height: auto;
}

/*
 * Style the default template messages for submit-success, submit-error, and submitting. These elements are inserted
 * by the form sanitizer when a POST form lacks the action-xhr attribute.
 */
.amp-wp-default-form-message > p {
	margin: 1em 0;
	padding: 0.5em;
}

.amp-wp-default-form-message[submitting] > p,
.amp-wp-default-form-message[submit-success] > p.amp-wp-form-redirecting {
	font-style: italic;
}

.amp-wp-default-form-message[submit-success] > p:not(.amp-wp-form-redirecting) {
	border: solid 1px #008000;
	background-color: #90ee90;
	color: #000;
}

.amp-wp-default-form-message[submit-error] > p {
	border: solid 1px #f00;
	background-color: #ffb6c1;
	color: #000;
}

/* Prevent showing empty success message in the case of an AMP-Redirect-To response header. */
.amp-wp-default-form-message[submit-success] > p:empty {
	display: none;
}

amp-carousel .amp-wp-gallery-caption {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	text-align: center;
	background-color: rgba(0, 0, 0, 0.5);
	color: #fff;
	padding: 1rem;
}

.wp-block-gallery[data-amp-carousel="true"] {
	display: block;
	flex-wrap: unset;
}

/* Template Styles */

.amp-wp-content,
.amp-wp-title-bar div {
		margin: 0 auto;
	max-width: 840px;
	}

html {
	background: #0a89c0;
}

body {
	background: #fff;
	color: #353535;
	font-family: Georgia, 'Times New Roman', Times, Serif;
	font-weight: 300;
	line-height: 1.75em;
}

p,
ol,
ul,
figure {
	margin: 0 0 1em;
	padding: 0;
}

a,
a:visited {
	color: #0a89c0;
}

a:hover,
a:active,
a:focus {
	color: #353535;
}

/* Quotes */

blockquote {
	color: #353535;
	background: rgba(127,127,127,.125);
	border-left: 2px solid #0a89c0;
	margin: 8px 0 24px 0;
	padding: 16px;
}

blockquote p:last-child {
	margin-bottom: 0;
}

/* UI Fonts */

.amp-wp-meta,
.amp-wp-header div,
.amp-wp-title,
.wp-caption-text,
.amp-wp-tax-category,
.amp-wp-tax-tag,
.amp-wp-comments-link,
.amp-wp-footer p,
.back-to-top {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif;
}

/* Header */

.amp-wp-header {
	background-color: #0a89c0;
}

.amp-wp-header div {
	color: #fff;
	font-size: 1em;
	font-weight: 400;
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: .875em 16px;
	position: relative;
}

.amp-wp-header a {
	color: #fff;
	text-decoration: none;
}


.amp-wp-header .amp-wp-site-icon {
	/** site icon is 32px **/
	background-color: #fff;
	border: 1px solid #fff;
	border-radius: 50%;
	position: absolute;
	right: 18px;
	top: 10px;
}

/* Article */

.amp-wp-article {
	color: #353535;
	font-weight: 400;
	margin: 1.5em auto;
	max-width: 840px;
	overflow-wrap: break-word;
	word-wrap: break-word;
}

/* Article Header */

.amp-wp-article-header {
	align-items: center;
	align-content: stretch;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	margin: 1.5em 16px 0;
}

.amp-wp-title {
	color: #353535;
	display: block;
	flex: 1 0 100%;
	font-weight: 900;
	margin: 0 0 .625em;
	width: 100%;
}

/* Article Meta */

.amp-wp-meta {
	color: #696969;
	display: inline-block;
	flex: 2 1 50%;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0 0 1.5em;
	padding: 0;
}

.amp-wp-article-header .amp-wp-meta:last-of-type {
	text-align: right;
}

.amp-wp-article-header .amp-wp-meta:first-of-type {
	text-align: left;
}

.amp-wp-byline amp-img,
.amp-wp-byline .amp-wp-author {
	display: inline-block;
	vertical-align: middle;
}

.amp-wp-byline amp-img {
	border: 1px solid #0a89c0;
	border-radius: 50%;
	position: relative;
	margin-right: 6px;
}

.amp-wp-posted-on {
	text-align: right;
}

/* Featured image */

.amp-wp-article-featured-image {
	margin: 0 0 1em;
}
.amp-wp-article-featured-image amp-img {
	margin: 0 auto;
}
.amp-wp-article-featured-image.wp-caption .wp-caption-text {
	margin: 0 18px;
}

/* Article Content */

.amp-wp-article-content {
	margin: 0 16px;
}

.amp-wp-article-content ul,
.amp-wp-article-content ol {
	margin-left: 1em;
}

.amp-wp-article-content .wp-caption {
	max-width: 100%;
}

.amp-wp-article-content amp-img {
	margin: 0 auto;
}

.amp-wp-article-content amp-img.alignright {
	margin: 0 0 1em 16px;
}

.amp-wp-article-content amp-img.alignleft {
	margin: 0 16px 1em 0;
}

/* Captions */

.wp-caption {
	padding: 0;
}

.wp-caption.alignleft {
	margin-right: 16px;
}

.wp-caption.alignright {
	margin-left: 16px;
}

.wp-caption .wp-caption-text {
	border-bottom: 1px solid #c2c2c2;
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: .66em 10px .75em;
}

/* AMP Media */

.alignwide,
.alignfull {
	clear: both;
}

amp-carousel {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}
amp-iframe,
amp-youtube,
amp-instagram,
amp-vine {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}

.amp-wp-article-content amp-carousel amp-img {
	border: none;
}

amp-carousel > amp-img > img {
	object-fit: contain;
}

.amp-wp-iframe-placeholder {
	background: #c2c2c2 url( https://uzzz.org/wp-content/plugins/amp/assets/images/placeholder-icon.png ) no-repeat center 40%;
	background-size: 48px 48px;
	min-height: 48px;
}

/* Article Footer Meta */

.amp-wp-article-footer .amp-wp-meta {
	display: block;
}

.amp-wp-tax-category,
.amp-wp-tax-tag {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 1.5em 16px;
}

.amp-wp-comments-link {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	text-align: center;
	margin: 2.25em 0 1.5em;
}

.amp-wp-comments-link a {
	border-style: solid;
	border-color: #c2c2c2;
	border-width: 1px 1px 2px;
	border-radius: 4px;
	background-color: transparent;
	color: #0a89c0;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 600;
	line-height: 18px;
	margin: 0 auto;
	max-width: 200px;
	padding: 11px 16px;
	text-decoration: none;
	width: 50%;
	-webkit-transition: background-color 0.2s ease;
			transition: background-color 0.2s ease;
}

/* AMP Footer */

.amp-wp-footer {
	border-top: 1px solid #c2c2c2;
	margin: calc(1.5em - 1px) 0 0;
}

.amp-wp-footer div {
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: 1.25em 16px 1.25em;
	position: relative;
}

.amp-wp-footer h2 {
	font-size: 1em;
	line-height: 1.375em;
	margin: 0 0 .5em;
}

.amp-wp-footer p {
	color: #696969;
	font-size: .8em;
	line-height: 1.5em;
	margin: 0 85px 0 0;
}

.amp-wp-footer a {
	text-decoration: none;
}

.back-to-top {
	bottom: 1.275em;
	font-size: .8em;
	font-weight: 600;
	line-height: 2em;
	position: absolute;
	right: 16px;
}
		/* Inline stylesheets */
:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .markdown_views{word-break:break-word}.markdown_views pre code{display:block;font-size:14px;line-height:22px;overflow-x:auto;white-space:pre;word-wrap:normal;background-color:#f6f8fa;border-radius:4px}@media screen and (-webkit-min-device-pixel-ratio:0){.markdown_views pre code{min-width:94%}}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .markdown_views pre code{padding:0}.markdown_views.prism-atom-one-dark pre code{background-color:#282c34;color:#abb2bf}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .markdown_views .prism .token.comment{font-family:"Microsoft YaHei"}@font-face{font-family:KaTeX_AMS;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_AMS-Regular.e78e28b.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_AMS-Regular.7f06b4e.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_AMS-Regular.aaf4eee.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Caligraphic-Bold.4ec58be.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Caligraphic-Bold.1e802ca.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Caligraphic-Bold.021dd4d.ttf") format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Caligraphic-Regular.7edb53b.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Caligraphic-Regular.d3b46c3.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Caligraphic-Regular.d49f2d5.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Fraktur-Bold.d5b59ec.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Fraktur-Bold.c4c8cab.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Fraktur-Bold.a31e7cb.ttf") format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Fraktur-Regular.32a5339.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Fraktur-Regular.b7d9c46.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Fraktur-Regular.a48dad4.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Main;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Bold.8e1e01c.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Bold.22086eb.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Bold.9ceff51.ttf") format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-BoldItalic.284a17f.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-BoldItalic.4c57dbc.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-BoldItalic.e8b44b9.ttf") format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Main;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Italic.e533d5a.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Italic.99be0e1.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Italic.29c8639.ttf") format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Regular.5c734d7.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Regular.b741441.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Main-Regular.5c94aef.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Math-BoldItalic.d747bd1.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Math-BoldItalic.b13731e.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Math-BoldItalic.9a2834a.ttf") format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Math;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Math-Italic.4ad08b8.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Math-Italic.f030390.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Math-Italic.291e76b.ttf") format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_SansSerif;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Bold.6e0830b.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Bold.3fb4195.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Bold.7dc027c.ttf") format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_SansSerif;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Italic.fba01c9.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Italic.727a9b0.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Italic.4059868.ttf") format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_SansSerif;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Regular.d929cd6.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Regular.2555754.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_SansSerif-Regular.5c58d16.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Script;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Script-Regular.755e249.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Script-Regular.d524c9a.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Script-Regular.d12ea9e.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size1;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size1-Regular.048c39c.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size1-Regular.08b5f00.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size1-Regular.7342d45.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size2;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size2-Regular.81d6b8d.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size2-Regular.af24b0e.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size2-Regular.eb130dc.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size3;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size3-Regular.b311ca0.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size3-Regular.0d89264.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size3-Regular.7e02a40.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size4-Regular.6a3255d.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size4-Regular.68895bb.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Size4-Regular.ad76725.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Typewriter;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Typewriter-Regular.6cc31ea.woff2") format("woff2"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Typewriter-Regular.3fe216d.woff") format("woff"),url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/KaTeX_Typewriter-Regular.2570235.ttf") format("truetype");font-weight:400;font-style:normal}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/RobotoMono-Regular.0b6a547.woff") format("woff")}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:600;src:url("https://csdnimg.cn/release/phoenix/mdeditor/fonts/RobotoMono-Bold.819f3b2.woff") format("woff")}.prism-atom-one-dark .prism{color:#abb2bf;background:#282c34}.prism-atom-one-dark .prism .token.comment{color:#5c6370}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .prism-atom-one-dark .prism *{font:400 14px Source Code Pro,DejaVu Sans Mono,Ubuntu Mono,Anonymous Pro,Droid Sans Mono,Menlo,Monaco,Consolas,Inconsolata,Courier,monospace,PingFang SC,Microsoft YaHei,sans-serif}.prism-atom-one-dark .prism .token.punctuation{color:#999}:root:not(#_):not(#_):not(#_):not(#_):not(#_):not(#_):not(#_) .prism-atom-one-dark .prism .token.comment{font-style:italic}.prism-atom-one-dark .prism .token.number{color:#98c379}.prism-atom-one-dark .prism .token.boolean{color:#56b6c2}.prism-atom-one-dark .prism .token.builtin,.prism-atom-one-dark .prism .token.string{color:#690}.prism-atom-one-dark .prism .token.operator{color:#690}.prism-atom-one-dark .prism .token.keyword{color:#c678dd}.prism-atom-one-dark .prism .token.function{color:#61aeee}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.markdown_views *{box-sizing:border-box}code,pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}strong{font-weight:inherit;font-weight:bolder}amp-img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}.markdown_views,body,html{font-family:-apple-system,SF UI Text,Arial,PingFang SC,Hiragino Sans GB,Microsoft YaHei,WenQuanYi Micro Hei,sans-serif}[hidden]{display:none}body,html{color:rgba(0,0,0,.75);font-variant-ligatures:common-ligatures;line-height:1.625;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;tab-size:4;-moz-tab-size:4;-o-tab-size:4}.markdown_views p,.markdown_views pre,.markdown_views ul{margin:1.2em 0}.markdown_views ul ul{margin:0}.markdown_views code *,.markdown_views pre *{font-size:inherit}.markdown_views code{padding:2px 4px}.markdown_views pre>code{background-color:rgba(0,0,0,.05);display:block;padding:.5em;-webkit-text-size-adjust:none;overflow-x:auto;white-space:pre}.markdown_views amp-img[src*="#pic_center"]{display:block;margin:auto}.markdown_views p{font-size:16px;color:#4d4d4d;font-weight:400;line-height:26px;margin:0 0 16px}.markdown_views strong{font-weight:700}.markdown_views h2{color:#4f4f4f;margin:8px 0 16px;font-weight:700}.markdown_views ul{margin:0 0 24px;padding:0;font-size:16px}.markdown_views ul li{list-style-type:disc;margin:8px 0 0 32px}.markdown_views amp-img{margin:24px 0;max-width:100%}.markdown_views h2{font-size:24px;line-height:32px}.markdown_views h2 code{font-size:24px}.markdown_views pre{margin-bottom:24px}.markdown_views pre code{color:unset}.markdown_views code,.markdown_views pre{font-family:Source Code Pro,DejaVu Sans Mono,Ubuntu Mono,Anonymous Pro,Droid Sans Mono,Menlo,Monaco,Consolas,Inconsolata,Courier,monospace,PingFang SC,Microsoft YaHei,sans-serif;font-size:14px;line-height:22px;color:#000}.markdown_views code{color:#c7254e;background-color:#f9f2f4;border-radius:2px}.markdown_views a{text-decoration-skip:ink;color:#4ea1db;text-decoration:none}.markdown_views a:focus,.markdown_views a:hover{text-decoration:none;color:#ca0c16}.markdown_views a:visited{color:#6795b5}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-224b51a{display:none}:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-7874ad7{-webkit-tap-highlight-color:rgba(0,0,0,0)}	</style>
</head>

<body class="">

<header id="top" class="amp-wp-header">
	<div>
		<a href="https://uzzz.org/">
										<amp-img src="https://uzzz.org/wp-content/uploads/2019/10/cropped-icon-32x32.png" width="32" height="32" class="amp-wp-site-icon"></amp-img>
						<span class="amp-site-title">
				有组织在!			</span>
		</a>

					</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">python数据分析：关联规则学习（Association rule learning）</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/e786821a74ef0467825a7d60183307bc?s=24&d=mm&r=g" alt="fandyvon" width="24" height="24" layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">fandyvon</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2018-12-01T14:58:03+00:00">
		1 year ago	</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<div id="article_content" class="article_content clearfix">
 <br>
 
 
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <br>
  <svg xmlns="http://www.w3.org/2000/svg" class="amp-wp-224b51a">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" class="amp-wp-7874ad7"></path>
  </svg> 
<h2><a id="_0"></a>何为关联规则学习</h2>
<p>关联规则学习是一种基于规则的机器学习方法，用于发现大型数据库中变量之间的有趣关系。它旨在使用一些有趣的度量来识别在数据库中发现的强规则。这种基于规则的方法在分析更多数据时也会生成新规则。假设数据集足够大，最终目标是帮助机器模拟人类大脑的特征提取和新未分类数据的抽象关联能力。</p>
<p>基于强有力规则的概念，Rakesh Agrawal，TomaszImieliński和Arun Swami介绍了关联规则，用于发现超市中销售点（POS）系统记录的大规模交易数据中产品之间的规律性。例如，在超市的销售数据中发现，如果顾客一起购买洋葱和土豆，他们也可能会购买汉堡肉。这些信息可以用作关于营销活动的决策的基础，例如促销定价或产品放置。</p>
<p>除了市场购物篮分析的上述示例之外，目前在许多应用领域中使用关联规则，包括Web使用挖掘，入侵检测，连续生产和生物信息学。与序列挖掘相反，关联规则学习通常不考虑事务内或跨事务的项目顺序。</p>
<h2><a id="_8"></a>常用的关联算法包括</h2>
<p>Apriori、FP-Growth、PrefixSpan、SPADE、AprioriAll、Apriori-Some等。</p>
<h2><a id="_12"></a>关联算法评估规则</h2>
<p>频繁规律与有效规则：</p>
<ul>
<li>频繁规则指的是关联结果中支持度和置信度都比较高的规则</li>
<li>有效规则指关联规则真正能促进规则中的前后项提升</li>
</ul>
<p>假如，数据集有1000条事务数据用来显示购买苹果和香蕉的订单记录，其中有600个客户的订单记录中包含了苹果，有800个客户的订单记录中包含了香蕉，而有400个客户同时购买了苹果和香蕉。假如我们产生了一条关联规则，用来表示购买了苹果的客户中还有很多人购买香蕉，那么该规则可以表示为：苹果→香蕉。<br> 支持度：support = 400/1000= 40%<br> 置信度：confidence = 400/600=67%<br> 如果只是看支持度和置信度，这个规则似乎非常显著的说明了苹果和香蕉之间的频繁关系，买了苹果的客户中有67%的人也会一起购买香蕉。但是，如果忽略购买苹果的事实，只购买香蕉的客户比例会高达是80%（800/1000）！这显示了购买苹果这种条件不会对购买香蕉产生积极的促进作用，反而会阻碍其销售，苹果和香蕉之间是一种负相关的关系。因此，只看支持度和置信度将无法完整体现规则的有效性，这里我们使用提升度来有效应对该问题。</p>
<p>提升度（Lift）指的是应用关联规则和不应用产生结果的比例。在本示例中，Lift=(400)/(800)=0.5（有关联规则的前提下只有400个客户会购买香蕉，没有关联规则的前提下会有800个购买香蕉）。当提升度为1时，说明应用关联规则和不应用关联规则产生相同的结果；当提升度大于1时，说明应用关联规则比不应用关联规则能产生更好的结果；当提升度小于1时，关联规则具有负相关的作用，该规则是无效规则。</p>
<p>做关联规则评估时，需要综合考虑支持度、置信度和提升度三个指标，支持度和置信度的值越大越好。</p>
<p>提升度低的负相关关联其实也是一种关联模式，也是可以通过避免的方式利用这种关联：不将互斥商品放在一个组合中，不将互斥广告投放整合投放，不将互斥关键字提供个客户，不将互斥信息流展现给客户。</p>
<h2><a id="_30"></a>运营分析中关联分析的使用</h2>
<ul>
<li>网站页面关联分析：帮助我们找到用户在不同页面之间的频繁访问关系，以分析用户特定的页面浏览方式，这样可以帮助了解不同页面之间的分流和引流情况，可用于不同页面间的推荐已达到提高转化率。</li>
<li>广告流量关联分析：针对站外广告投放渠道用户浏览或点击的行为分析，该分析主要用于了解用户的浏览和点击广告的规则。这种站外广告曝光和点击的关联分析可以为广告客户的精准投放提供参考。</li>
<li>用户关键字搜索：通过分析用户在站内的搜索关键字了解用户真实需求的。通过对用户搜索的关键字的关联分析，可以得到类似于搜索了iPhone又搜索了三星，这种关联可以用于搜索推荐、搜索关联等场景，有助于改善搜索体验，提高客户的目标转化率。</li>
<li>不同场景发生，这种模式可以广泛用于分析运营中关注的要素，例如用户浏览商品和购买商品的关联，关注产品价格和购买产品价格的关联，加入购物车与购买的关联。这种关联可以找到用户在一个事件中不同行为之间的关联，可以用来挖掘用户的真实需求，有针对性的对当前用户进行个性化推荐，同时也对定价策略有参考价值。</li>
<li>相同场景发生，用户在同一个页面中点击不同功能、选择不同的应用。这种关联可以用于分析用户使用功能的先后顺序，有利于做产品优化和用户体验提升；对于不同产品功能组合、开发和升级有了更加明确地参考方向，便于针对永辉习惯性操作模式做功能迭代；同时针对用户频繁查看和点击的内容，可以采用打包、组合、轮转等策略，帮助客户查找，同时增加内容曝光度和用户体验。</li>
</ul>
<h2><a id="python_38"></a>python代码实现</h2>
<p>apriori模块：</p>
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">from</span> numpy <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> re

<span class="token keyword">def</span> <span class="token function">createData</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    req <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>r<span class="token string">','</span><span class="token punctuation">)</span>
    fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
    content <span class="token operator">=</span> fr<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> content<span class="token punctuation">:</span>
        tem <span class="token operator">=</span> line<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        mat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tem<span class="token punctuation">)</span>
    <span class="token keyword">return</span> mat

<span class="token keyword">def</span> <span class="token function">loadDataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment"># C1 是大小为1的所有候选项集的集合</span>
<span class="token keyword">def</span> <span class="token function">createC1</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    C1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> transaction <span class="token keyword">in</span> dataSet<span class="token punctuation">:</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> transaction<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token keyword">in</span> C1<span class="token punctuation">:</span>
                C1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#store all the item unrepeatly</span>

    C1<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#return map(frozenset, C1)#frozen set, user can't change it.</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">frozenset</span><span class="token punctuation">,</span> C1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">scanD</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span>Ck<span class="token punctuation">,</span>minSupport<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ssCnt<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> tid <span class="token keyword">in</span> D<span class="token punctuation">:</span>
        <span class="token keyword">for</span> can <span class="token keyword">in</span> Ck<span class="token punctuation">:</span>
            <span class="token keyword">if</span> can<span class="token punctuation">.</span>issubset<span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment">#if not ssCnt.has_key(can):</span>
                <span class="token keyword">if</span> <span class="token operator">not</span> can <span class="token keyword">in</span> ssCnt<span class="token punctuation">:</span>
                    ssCnt<span class="token punctuation">[</span>can<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span> ssCnt<span class="token punctuation">[</span>can<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
    numItems<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span>
    retList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    supportData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> ssCnt<span class="token punctuation">:</span>
        support <span class="token operator">=</span> ssCnt<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">/</span>numItems   <span class="token comment">#compute support</span>
        <span class="token keyword">if</span> support <span class="token operator">>=</span> minSupport<span class="token punctuation">:</span>
            retList<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
        supportData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> support
    <span class="token keyword">return</span> retList<span class="token punctuation">,</span> supportData

<span class="token comment">#total apriori</span>
<span class="token keyword">def</span> <span class="token function">aprioriGen</span><span class="token punctuation">(</span>Lk<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#组合，向上合并</span>
    <span class="token comment">#creates Ck 参数：频繁项集列表 Lk 与项集元素个数 k</span>
    retList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    lenLk <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>Lk<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>lenLk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> lenLk<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#两两组合遍历</span>
            L1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Lk<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>k<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> L2 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Lk<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>k<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
            L1<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> L2<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> L1<span class="token operator">==</span>L2<span class="token punctuation">:</span> <span class="token comment">#若两个集合的前k-2个项相同时,则将两个集合合并</span>
                retList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Lk<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">|</span> Lk<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#set union</span>
    <span class="token keyword">return</span> retList

<span class="token comment">#apriori</span>
<span class="token keyword">def</span> <span class="token function">apriori</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> minSupport <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    C1 <span class="token operator">=</span> createC1<span class="token punctuation">(</span>dataSet<span class="token punctuation">)</span>
    D <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">,</span> dataSet<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#python3</span>
    L1<span class="token punctuation">,</span> supportData <span class="token operator">=</span> scanD<span class="token punctuation">(</span>D<span class="token punctuation">,</span> C1<span class="token punctuation">,</span> minSupport<span class="token punctuation">)</span><span class="token comment">#单项最小支持度判断 0.5，生成L1</span>
    L <span class="token operator">=</span> <span class="token punctuation">[</span>L1<span class="token punctuation">]</span>
    k <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>L<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#创建包含更大项集的更大列表,直到下一个大的项集为空</span>
        Ck <span class="token operator">=</span> aprioriGen<span class="token punctuation">(</span>L<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token comment">#Ck</span>
        Lk<span class="token punctuation">,</span> supK <span class="token operator">=</span> scanD<span class="token punctuation">(</span>D<span class="token punctuation">,</span> Ck<span class="token punctuation">,</span> minSupport<span class="token punctuation">)</span><span class="token comment">#get Lk</span>
        supportData<span class="token punctuation">.</span>update<span class="token punctuation">(</span>supK<span class="token punctuation">)</span>
        L<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Lk<span class="token punctuation">)</span>
        k <span class="token operator">+=</span> <span class="token number">1</span> <span class="token comment">#继续向上合并 生成项集个数更多的</span>
    <span class="token keyword">return</span> L<span class="token punctuation">,</span> supportData

<span class="token comment">#生成关联规则</span>
<span class="token comment"># 创建关联规则</span>
<span class="token keyword">def</span> <span class="token function">generateRules</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> L<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> minConf<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># supportData是从scanD获得的字段</span>
    bigRuleList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 只获得又有2个或以上的项目的集合</span>
        <span class="token keyword">for</span> freqSet <span class="token keyword">in</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            H1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">frozenset</span><span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> freqSet<span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                rulesFromConseq<span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> freqSet<span class="token punctuation">,</span> H1<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> bigRuleList<span class="token punctuation">,</span> minConf<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                calcConf<span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> freqSet<span class="token punctuation">,</span> H1<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> bigRuleList<span class="token punctuation">,</span> minConf<span class="token punctuation">)</span>
    <span class="token keyword">return</span> bigRuleList

<span class="token comment"># 实例数、支持度、置信度和提升度评估</span>
<span class="token keyword">def</span> <span class="token function">calcConf</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> freqSet<span class="token punctuation">,</span> H<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> brl<span class="token punctuation">,</span> minConf<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    prunedH <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    D <span class="token operator">=</span> fileName
    numItems <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> conseq <span class="token keyword">in</span> H<span class="token punctuation">:</span>
        conf <span class="token operator">=</span> supportData<span class="token punctuation">[</span>freqSet<span class="token punctuation">]</span> <span class="token operator">/</span> supportData<span class="token punctuation">[</span>freqSet <span class="token operator">-</span> conseq<span class="token punctuation">]</span>  <span class="token comment"># 计算置信度</span>
        <span class="token keyword">if</span> conf <span class="token operator">>=</span> minConf<span class="token punctuation">:</span>
            instances <span class="token operator">=</span> numItems <span class="token operator">*</span> supportData<span class="token punctuation">[</span>freqSet<span class="token punctuation">]</span>  <span class="token comment"># 计算实例数</span>
            liftvalue <span class="token operator">=</span> conf <span class="token operator">/</span> supportData<span class="token punctuation">[</span>conseq<span class="token punctuation">]</span>  <span class="token comment"># 计算提升度</span>
            brl<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>freqSet <span class="token operator">-</span> conseq<span class="token punctuation">,</span> conseq<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>instances<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>supportData<span class="token punctuation">[</span>freqSet<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>conf<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token builtin">round</span><span class="token punctuation">(</span>liftvalue<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 支持度已经在SCAND中计算得出</span>
            prunedH<span class="token punctuation">.</span>append<span class="token punctuation">(</span>conseq<span class="token punctuation">)</span>
    <span class="token keyword">return</span> prunedH

<span class="token comment"># 生成候选规则集</span>
<span class="token keyword">def</span> <span class="token function">rulesFromConseq</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> freqSet<span class="token punctuation">,</span> H<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> brl<span class="token punctuation">,</span> minConf<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>H<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>freqSet<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        Hmp1 <span class="token operator">=</span> aprioriGen<span class="token punctuation">(</span>H<span class="token punctuation">,</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        Hmp1 <span class="token operator">=</span> calcConf<span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> freqSet<span class="token punctuation">,</span> Hmp1<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> brl<span class="token punctuation">,</span> minConf<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Hmp1<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            rulesFromConseq<span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> freqSet<span class="token punctuation">,</span> Hmp1<span class="token punctuation">,</span> supportData<span class="token punctuation">,</span> brl<span class="token punctuation">,</span> minConf<span class="token punctuation">)</span>

</code></pre>
<p>apriori算法实现:</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> apriori
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> graphviz <span class="token keyword">import</span> Digraph

<span class="token comment"># 设置最小支持度阈值</span>
minS <span class="token operator">=</span> <span class="token number">0.5</span>
<span class="token comment"># 设置最小置信度阈值</span>
minC <span class="token operator">=</span> <span class="token number">0.7</span>

data <span class="token operator">=</span> apriori<span class="token punctuation">.</span>loadDataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 计算符合最小支持度的规则</span>
L<span class="token punctuation">,</span> suppdata <span class="token operator">=</span> apriori<span class="token punctuation">.</span>apriori<span class="token punctuation">(</span>data<span class="token punctuation">,</span> minSupport<span class="token operator">=</span>minS<span class="token punctuation">)</span>

<span class="token comment"># 计算满足最小置信度规则</span>
rules <span class="token operator">=</span> apriori<span class="token punctuation">.</span>generateRules<span class="token punctuation">(</span>data<span class="token punctuation">,</span> L<span class="token punctuation">,</span> suppdata<span class="token punctuation">,</span> minConf<span class="token operator">=</span>minC<span class="token punctuation">)</span>

<span class="token comment">### 关联结果评估###</span>
model_summary <span class="token operator">=</span> <span class="token string">'data record: {1} \nassociation rules count: {0}'</span>  <span class="token comment"># 展示数据集记录数和满足阈值定义的规则数量</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span>model_summary<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>rules<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 使用str.format做格式化输出</span>
df <span class="token operator">=</span>  pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>rules<span class="token punctuation">,</span>  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'item1'</span><span class="token punctuation">,</span>  <span class="token string">'itme2'</span><span class="token punctuation">,</span>  <span class="token string">'instance'</span><span class="token punctuation">,</span>  <span class="token string">'support'</span><span class="token punctuation">,</span>
    <span class="token string">'confidence'</span><span class="token punctuation">,</span> <span class="token string">'lift'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 创建频繁规则数据框</span>
df_lift <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'lift'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">1.0</span><span class="token punctuation">]</span>  <span class="token comment"># 只选择提升度>1的规则</span>
df_lift<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'instance'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre>
<p><amp-img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20181201143702923.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RvbnlkejA1MjM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" width="510" height="230" class="amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20181201143702923.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RvbnlkejA1MjM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" width="510" height="230" class=""></noscript></amp-img></p>
<pre><code class="prism language-python"><span class="token comment"># 关联结果图形展示</span>
dot <span class="token operator">=</span> Digraph<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建有向图</span>
graph_data <span class="token operator">=</span> df_lift<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'item1'</span><span class="token punctuation">,</span> <span class="token string">'itme2'</span><span class="token punctuation">,</span> <span class="token string">'instance'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>   <span class="token comment"># 切分画图用的前项、后项和实例数数据</span>
<span class="token keyword">for</span> each_data <span class="token keyword">in</span> graph_data<span class="token punctuation">.</span>values<span class="token punctuation">:</span>  <span class="token comment"># 循环读出每条规则</span>
    node1<span class="token punctuation">,</span> node2<span class="token punctuation">,</span> weight <span class="token operator">=</span> each_data  <span class="token comment"># 分割每条数据画图用的前项、后项和实例数</span>
    node1 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>node1<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'frozenset({})'</span><span class="token punctuation">)</span>  <span class="token comment"># 转化为字符串</span>
    node2 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>node2<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'frozenset({})'</span><span class="token punctuation">)</span>  <span class="token comment"># 转化为字符串</span>
    label <span class="token operator">=</span> <span class="token string">'%s'</span> <span class="token operator">%</span> weight  <span class="token comment"># 创建一个标签用于展示实例数</span>
    dot<span class="token punctuation">.</span>node<span class="token punctuation">(</span>node1<span class="token punctuation">,</span> node1<span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token string">'record'</span><span class="token punctuation">)</span>  <span class="token comment"># 增加节点（规则中的前项）</span>
    dot<span class="token punctuation">.</span>edge<span class="token punctuation">(</span>node1<span class="token punctuation">,</span> node2<span class="token punctuation">,</span> label<span class="token operator">=</span>label<span class="token punctuation">,</span> constraint<span class="token operator">=</span><span class="token string">'true'</span><span class="token punctuation">)</span>  <span class="token comment"># 增加有向边</span>
dot<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'apriori'</span><span class="token punctuation">,</span> view<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 保存规则为pdf文件</span>
</code></pre>
<p><amp-img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20181201143745524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RvbnlkejA1MjM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" width="442" height="401" class="amp-wp-enforced-sizes" layout="intrinsic"><noscript><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20181201143745524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RvbnlkejA1MjM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" width="442" height="401" class=""></noscript></amp-img></p>
<p>使用pyfpgrowth模块实现FP-Growth：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pyfpgrowth
<span class="token comment"># 数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># 设置支持度和置信度</span>
minS <span class="token operator">=</span> <span class="token number">0.2</span>
minC <span class="token operator">=</span> <span class="token number">0.7</span>
<span class="token comment"># 计算支持值</span>
support <span class="token operator">=</span> minS<span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token comment"># 获取符合支持度规则数据</span>
patterns <span class="token operator">=</span> pyfpgrowth<span class="token punctuation">.</span>find_frequent_patterns<span class="token punctuation">(</span>data<span class="token punctuation">,</span> support<span class="token punctuation">)</span>
<span class="token comment"># 获取符合置信度规则数据</span>
rules <span class="token operator">=</span> pyfpgrowth<span class="token punctuation">.</span>generate_association_rules<span class="token punctuation">(</span>patterns<span class="token punctuation">,</span> minC<span class="token punctuation">)</span>

rules
</code></pre>
<p>结果如下：</p>
<p>{(5,): ((1, 2), 1.0),<br> (1, 5): ((2,), 1.0),<br> (2, 5): ((1,), 1.0),<br> (4,): ((2,), 1.0)}</p>
<h2><a id="_238"></a>补充</h2>
<p>除了打包组合的思维方式之外，还可以这样考虑应用：既然用户具有较强的发生关联事件关系（例如购买、查看等）的可能性，那么可以基于用户的这种习惯，将前后项内容故意分离开，利用用户主动查找的时机来产生更多价值或完成特定转化目标。<br> 例如：用户经常一起购买啤酒和尿布，我们可以分别将啤酒和尿布陈列在展柜的两端（或者隔开一段距离），然后在用户购买啤酒又去购买尿布的途中，也许会发现别的商品进而产生兴趣，从而实现更多的销售。但是需要注意这种关联需求的效用能否支撑这种搜索过程，则刚需最好，强有效规则其次，不可过多降低用户体验。</p>
<h2><a id="_243"></a>序列模式的关联规则：</h2>
<p>序列模式相较于普通关联模式最大的区别是不同的事件之间具有明显的时间区隔，以及先后的序列发生关系，能得到类似于“完成某个事件之后会在特定的时间周期内完成其他事件”的结论，例如购买了冰箱的客户会在3个月内购买洗衣机的结论。这是一种预测性分析的模式，能够将事件发生的时间和对象提取出来，使用与基于时间序列的数据化运营需求。<br> 应用场景：</p>
<ul>
<li>基于用户上一次购买时间和商品信息，推断用户下一次购物时间和购买的商品，如果用户脱离周期过久需要实施挽留措施</li>
<li>基于用户上一次浏览页面的时间和页面信息，推断用户下一次可能浏览的页面</li>
<li>通过上衣此关键字的搜索预测下一次最可能搜索的关键字</li>
</ul>
<p>能实现序列模式的关联算法包括：</p>
<ul>
<li>AprioriAll：基于哈希树的序列关联算法，它与Apriori算法的执行过程是一样的，不同点在于候选集的产生，需要区分最后两个元素的前后顺序。</li>
<li>AprioriSome：该算法是对AprioriAll算法的改进。</li>
<li>CARMA（Continuous Association Rule Mining Algorithm）:CARMA是一种比较新的关联规则算法，能够处理在线连续交易流数据。</li>
<li>GSP（Generalized Sequential Patterns）：基于水平存储结构和哈希树遍历操作的序列关联算法，它具有类似于Apriori算法的实现步骤，主要区别在于产生候选序列模式。</li>
<li>SPADE（Sequential PAttern Discovery using Equivalence classes）：基于垂直存储结构和格理论连接操作的序列关联算法，它是一种改进的GSP算法。</li>
<li>FreeSpan：频繁模式投影的序列关联算法，利用频繁项递归地将序列数据库投影到更小的投影数据库集中，在每个投影数据库中生成子序列片断，是一种分治思想的算法。</li>
<li>PrefixSpan（Prefix-Projected Pattern Growth）：基于前缀树的序列关联算法，从Free-Span中推导演化而来</li>
</ul>
<p><strong>参考：<br> 《python数据分析与数据化运营》 宋天龙</strong></p>
</div>

</div>
	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: <a href="https://uzzz.org/category/dashuju/" rel="category tag">大数据</a>	</div>

	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>有组织在!</h2>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>



</body>
</html>
